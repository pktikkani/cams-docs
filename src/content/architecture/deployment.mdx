# Deployment

## Backend API

The Go backend is deployed as a containerized service:

- **Hosting**: Railway (PaaS)
- **URL**: `https://contractor-api.nubewired.com`
- **Database**: PostgreSQL 15 on Railway
- **SSL**: Automatic TLS via Railway

## Admin Portal

The Next.js admin portal can be deployed to:

- **Vercel** (recommended for Next.js)
- **Railway** (same platform as backend)
- **Any Node.js hosting** supporting Next.js

### Environment Variables

```bash
# Required
DATABASE_URL=postgresql://user:pass@host:5432/dbname
JWT_SECRET=your-secret-key

# Optional
DB_SSL=true
```

### Build & Deploy

```bash
npm install
npm run build
npm start
```

## Mobile Apps

### Android
- **Distribution**: Google Play Store or direct APK
- **Min SDK**: API 26 (Android 8.0)
- **Build**: Android Studio + Gradle (Kotlin DSL)

### iOS
- **Distribution**: App Store or TestFlight
- **Min iOS**: 16.0
- **Build**: Xcode 15+

## Database Migrations

Run migrations to set up the database schema:

```bash
npx tsx src/server/db/migrate.ts
```

This creates all required tables:
- `admin_users` with role-based access
- `scanner_devices` with site assignments
- Default super admin user: `admin@cams.com` / `admin123`

## Infrastructure Diagram

```mermaid
graph TB
    subgraph Clients
        IOS[üì± iOS Apps]
        AND[üì± Android Apps]
        WEB[üåê Browser]
    end

    subgraph Hosting
        AP[üñ•Ô∏è Admin Portal<br/>Vercel / Railway]
        BE[‚öôÔ∏è Go Backend<br/>Railway]
        DB[(üêò PostgreSQL<br/>Railway)]
    end

    WEB -->|HTTPS| AP
    AP -->|DATABASE_URL| DB
    BE -->|SQL| DB
    IOS -->|HTTPS REST| BE
    AND -->|HTTPS REST| BE

    style AP fill:#10b981,color:#fff
    style BE fill:#f59e0b,color:#fff
    style DB fill:#3b82f6,color:#fff
    style IOS fill:#06b6d4,color:#fff
    style AND fill:#06b6d4,color:#fff
    style WEB fill:#8b5cf6,color:#fff
```
